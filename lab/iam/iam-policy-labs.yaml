Version: "2012-10-17"
Statement:
  - Effect: Allow
    Action:
      - aps:CreateWorkspace
    Resource: ["*"]
    Condition:
      StringLike:
        aws:RequestTag/env:
          - ${Environment}*
  - Effect: Allow
    Action:
      - aps:DeleteWorkspace
      - aps:Describe*
      - aps:List*
    Resource: ["*"]
    Condition:
      StringLike:
        aws:ResourceTag/env:
          - ${Environment}*
  - Effect: Allow
    Action:
      - dynamodb:ListTables
    Resource: ["*"]
  - Effect: Allow
    Action:
      - dynamodb:CreateTable
      - dynamodb:DeleteTable
      - dynamodb:DescribeTable
      - dynamodb:DescribeContinuousBackups
      - dynamodb:ListTagsOfResource
      - dynamodb:DescribeTimeToLive
      - dynamodb:Scan
      - dynamodb:TagResource
    Resource:
      - arn:aws:dynamodb:${Region}:${Account}:table/${Environment}*
  - Effect: Allow
    Action:
      - secretsmanager:ListSecrets
    Resource: ["*"]
  - Effect: Allow
    Action:
      - secretsmanager:CreateSecret
      - secretsmanager:DeleteSecret
      - secretsmanager:DescribeSecret
    Resource:
      - arn:aws:secretsmanager:${Region}:${Account}:secret:${Environment}*
  - Effect: Allow
    Action:
      - secretsmanager:ListSecrets
    Resource: ["*"]
  - Effect: Allow
    Action:
      - sqs:CreateQueue
      - sqs:DeleteQueue
      - sqs:GetQueueAttributes
      - sqs:SetQueueAttributes
      - sqs:TagQueue
      - sqs:ListQueueTags
    Resource:
      - arn:aws:sqs:${Region}:${Account}:${Environment}*
  - Effect: Allow
    Action:
      - rds:CreateDBInstance
      - rds:CreateTenantDatabase
      - rds:DeleteDBInstance
      - rds:DeleteTenantDatabase
      - rds:DescribeDBInstances
      - rds:AddTagsToResource
    Resource:
      - arn:aws:rds:${Region}:${Account}:db:${Environment}*
  - Effect: Allow
    Action:
      - rds:CreateDBSubnetGroup
      - rds:DeleteDBSubnetGroup
      - rds:DescribeDBSubnetGroups
      - rds:AddTagsToResource
    Resource:
      - arn:aws:rds:${Region}:${Account}:subgrp:${Environment}*
  - Effect: Allow
    Action:
      - lambda:AddPermission
      - lambda:CreateFunction
      - lambda:DeleteFunction
      - lambda:GetFunction
      - lambda:GetFunctionCodeSigningConfig
      - lambda:GetPolicy
      - lambda:GetRuntimeManagementConfig
      - lambda:ListVersionsByFunction
      - lambda:RemovePermission
    Resource:
      - arn:aws:lambda:${Region}:${Account}:function:${Environment}*
  - Effect: Allow
    Action:
      - es:CreateDomain
      - es:DeleteDomain
      - es:DescribeDomain
      - es:DescribeDomainConfig
      - es:GetCompatibleVersions
      - es:ListTags
      - es:AddTags
    Resource:
      - arn:aws:es:${Region}:${Account}:domain/${Environment}*
  - Effect: Allow
    Action:
      - elasticloadbalancing:Describe*
      - elasticloadbalancing:Get*
    Resource: ["*"]
  - Effect: Allow
    Action:
      - cloudwatch:DeleteDashboards
      - cloudwatch:GetDashboard
      - cloudwatch:PutDashboard
    Resource:
      - arn:aws:cloudwatch::${Account}:dashboard/*
  - Effect: Allow
    Action:
      - ecr:CreateRepository
      - ecr:DeleteRepository
      - ecr:DescribeRepositories
      - ecr:ListTagsForResource
      - ecr:TagResource
    Resource:
      - arn:aws:ecr:${Region}:${Account}:repository/retail-store-sample*
      - arn:aws:ecr:${Region}:${Account}:repository/${Environment}*
  - Effect: Allow
    Action:
      - codepipeline:ListTagsForResource
    Resource: ["*"]
  - Effect: Allow
    Action:
      - codepipeline:CreatePipeline
      - codepipeline:DeletePipeline
      - codepipeline:Get*
    Resource:
      - arn:aws:codepipeline:${Region}:${Account}:${Environment}*
  - Effect: Allow
    Action:
      - guardduty:CreateDetector
      - guardduty:DeleteDetector
      - guardduty:ListDetectors
    Resource: ["*"]
  - Effect: Allow
    Action:
      - logs:DescribeLogGroups
      - logs:ListTagsForResource
    Resource: ["*"]
  - Effect: Allow
    Action:
      - logs:CreateLogGroup
      - logs:DeleteLogGroup
      - logs:DeleteSubscriptionFilter
      - logs:PutRetentionPolicy
      - logs:PutSubscriptionFilter
      - logs:TagResource
      - logs:TagLogGroup
      - logs:Get*
      - logs:Describe*
      - logs:List*
    Resource:
      - arn:aws:logs:${Region}:${Account}:log-group:${Environment}*
      - arn:aws:logs:${Region}:${Account}:log-group:/aws/eks/${Environment}*
  - Effect: Allow
    Action:
      - events:DeleteRule
      - events:DescribeRule
      - events:ListTagsForResource
      - events:ListTargetsByRule
      - events:PutRule
      - events:PutTargets
      - events:RemoveTargets
      - events:TagResource
    Resource:
      - arn:aws:events:${Region}:${Account}:rule/eks-workshop*
  - Effect: Allow
    Action:
      - vpc-lattice:List*
      - vpc-lattice:Get*
      - vpc-lattice:DeleteServiceNetwork
      - vpc-lattice:DeleteServiceNetworkVpcAssociation
    Resource: ["*"]
  - Effect: Allow
    Action:
      - elasticfilesystem:CreateFileSystem
      - elasticfilesystem:CreateMountTarget
      - elasticfilesystem:DeleteFileSystem
      - elasticfilesystem:DeleteMountTarget
      - elasticfilesystem:DescribeLifecycleConfiguration
      - elasticfilesystem:DescribeMountTargetSecurityGroups
      - elasticfilesystem:DescribeMountTargets
      - elasticfilesystem:CreateTags
      - elasticfilesystem:TagResource
      - elasticfilesystem:DescribeFileSystems
    Resource:
      - arn:aws:elasticfilesystem:${Region}:${Account}:file-system/*
  - Effect: Allow
    Action:
      - s3:CreateBucket
      - s3:DeleteBucket
      - s3:Get*
      - s3:PutBucketPublicAccessBlock
      - s3:PutBucketTagging
    Resource:
      - arn:aws:s3:::${Environment}*
